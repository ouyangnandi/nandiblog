"use strict";goog.provide("Blockly.Language.text");goog.require("Blockly.Language");Blockly.Language.text={helpUrl:Blockly.LANG_TEXT_TEXT_HELPURL,init:function(){this.setColour(160);this.appendDummyInput().appendTitle(new Blockly.FieldImage(Blockly.pathToBlockly+"media/quote0.png",12,12)).appendTitle(new Blockly.FieldTextInput(""),"TEXT").appendTitle(new Blockly.FieldImage(Blockly.pathToBlockly+"media/quote1.png",12,12));this.setOutput(true,String);this.setTooltip(Blockly.LANG_TEXT_TEXT_TOOLTIP)}};Blockly.Language.text_join={helpUrl:Blockly.LANG_TEXT_JOIN_HELPURL,init:function(){this.setColour(160);this.appendValueInput("ADD0").appendTitle(Blockly.LANG_TEXT_JOIN_TITLE_CREATEWITH);this.appendValueInput("ADD1");this.setOutput(true,String);this.setMutator(new Blockly.Mutator(["text_create_join_item"]));this.setTooltip(Blockly.LANG_TEXT_JOIN_TOOLTIP);this.itemCount_=2},mutationToDom:function(){var a=document.createElement("mutation");a.setAttribute("items",this.itemCount_);return a},domToMutation:function(c){for(var a=0;a<this.itemCount_;a++){this.removeInput("ADD"+a)}this.itemCount_=window.parseInt(c.getAttribute("items"),10);for(var a=0;a<this.itemCount_;a++){var b=this.appendValueInput("ADD"+a);if(a==0){b.appendTitle(Blockly.LANG_TEXT_JOIN_TITLE_CREATEWITH)}}if(this.itemCount_==0){this.appendDummyInput("EMPTY").appendTitle(new Blockly.FieldImage(Blockly.pathToBlockly+"media/quote0.png",12,12)).appendTitle(new Blockly.FieldImage(Blockly.pathToBlockly+"media/quote1.png",12,12))}},decompose:function(e){var c=new Blockly.Block(e,"text_create_join_container");c.initSvg();var d=c.getInput("STACK").connection;for(var b=0;b<this.itemCount_;b++){var a=new Blockly.Block(e,"text_create_join_item");a.initSvg();d.connect(a.previousConnection);d=a.nextConnection}return c},compose:function(c){if(this.itemCount_==0){this.removeInput("EMPTY")}else{for(var b=this.itemCount_-1;b>=0;b--){this.removeInput("ADD"+b)}}this.itemCount_=0;var a=c.getInputTargetBlock("STACK");while(a){var d=this.appendValueInput("ADD"+this.itemCount_);if(this.itemCount_==0){d.appendTitle(Blockly.LANG_TEXT_JOIN_TITLE_CREATEWITH)}if(a.valueConnection_){d.connection.connect(a.valueConnection_)}this.itemCount_++;a=a.nextConnection&&a.nextConnection.targetBlock()}if(this.itemCount_==0){this.appendDummyInput("EMPTY").appendTitle(new Blockly.FieldImage(Blockly.pathToBlockly+"media/quote0.png",12,12)).appendTitle(new Blockly.FieldImage(Blockly.pathToBlockly+"media/quote1.png",12,12))}},saveConnections:function(c){var b=c.getInputTargetBlock("STACK");var a=0;while(b){var d=this.getInput("ADD"+a);b.valueConnection_=d&&d.connection.targetConnection;a++;b=b.nextConnection&&b.nextConnection.targetBlock()}}};Blockly.Language.text_create_join_container={init:function(){this.setColour(160);this.appendDummyInput().appendTitle(Blockly.LANG_TEXT_CREATE_JOIN_TITLE_JOIN);this.appendStatementInput("STACK");this.setTooltip(Blockly.LANG_TEXT_CREATE_JOIN_TOOLTIP);this.contextMenu=false}};Blockly.Language.text_create_join_item={init:function(){this.setColour(160);this.appendDummyInput().appendTitle(Blockly.LANG_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM);this.setPreviousStatement(true);this.setNextStatement(true);this.setTooltip(Blockly.LANG_TEXT_CREATE_JOIN_ITEM_TOOLTIP);this.contextMenu=false}};Blockly.Language.text_append={helpUrl:Blockly.LANG_TEXT_APPEND_HELPURL,init:function(){this.setColour(160);this.appendValueInput("TEXT").appendTitle(Blockly.LANG_TEXT_APPEND_TO).appendTitle(new Blockly.FieldVariable(Blockly.LANG_TEXT_APPEND_VARIABLE),"VAR").appendTitle(Blockly.LANG_TEXT_APPEND_APPENDTEXT);this.setPreviousStatement(true);this.setNextStatement(true);var a=this;this.setTooltip(function(){return Blockly.LANG_TEXT_APPEND_TOOLTIP.replace("%1",a.getTitleValue("VAR"))})},getVars:function(){return[this.getTitleValue("VAR")]},renameVar:function(b,a){if(Blockly.Names.equals(b,this.getTitleValue("VAR"))){this.setTitleValue(a,"VAR")}}};Blockly.Language.text_length={helpUrl:Blockly.LANG_TEXT_LENGTH_HELPURL,init:function(){this.setColour(160);this.appendValueInput("VALUE").setCheck([String,Array]).appendTitle(Blockly.LANG_TEXT_LENGTH_INPUT_LENGTH);this.setOutput(true,Number);this.setTooltip(Blockly.LANG_TEXT_LENGTH_TOOLTIP)}};Blockly.Language.text_isEmpty={helpUrl:Blockly.LANG_TEXT_ISEMPTY_HELPURL,init:function(){this.setColour(160);this.appendValueInput("VALUE").setCheck([String,Array]);this.appendDummyInput().appendTitle(Blockly.LANG_TEXT_ISEMPTY_INPUT_ISEMPTY);this.setInputsInline(true);this.setOutput(true,Boolean);this.setTooltip(Blockly.LANG_TEXT_ISEMPTY_TOOLTIP)}};Blockly.Language.text_endString={helpUrl:Blockly.LANG_TEXT_ENDSTRING_HELPURL,init:function(){this.setColour(160);this.setOutput(true,String);var a=new Blockly.FieldDropdown(this.OPERATORS);this.appendValueInput("NUM").setCheck(Number).appendTitle(a,"END");this.appendValueInput("TEXT").setCheck(String).appendTitle(Blockly.LANG_TEXT_ENDSTRING_INPUT);this.setInputsInline(true);this.setTooltip(Blockly.LANG_TEXT_ENDSTRING_TOOLTIP)}};Blockly.Language.text_endString.OPERATORS=[[Blockly.LANG_TEXT_ENDSTRING_OPERATOR_FIRST,"FIRST"],[Blockly.LANG_TEXT_ENDSTRING_OPERATOR_LAST,"LAST"]];Blockly.Language.text_indexOf={helpUrl:Blockly.LANG_TEXT_INDEXOF_HELPURL,init:function(){this.setColour(160);this.setOutput(true,Number);this.appendValueInput("VALUE").setCheck(String).appendTitle(Blockly.LANG_TEXT_INDEXOF_INPUT_INTEXT);this.appendValueInput("FIND").setCheck(String).appendTitle(Blockly.LANG_TEXT_INDEXOF_TITLE_FIND).appendTitle(new Blockly.FieldDropdown(this.OPERATORS),"END").appendTitle(Blockly.LANG_TEXT_INDEXOF_INPUT_OCCURRENCE);this.setInputsInline(true);this.setTooltip(Blockly.LANG_TEXT_INDEXOF_TOOLTIP)}};Blockly.Language.text_indexOf.OPERATORS=[[Blockly.LANG_TEXT_INDEXOF_OPERATOR_FIRST,"FIRST"],[Blockly.LANG_TEXT_INDEXOF_OPERATOR_LAST,"LAST"]];Blockly.Language.text_charAt={helpUrl:Blockly.LANG_TEXT_CHARAT_HELPURL,init:function(){this.setColour(160);this.setOutput(true,String);this.appendValueInput("VALUE").setCheck(String).appendTitle(Blockly.LANG_TEXT_CHARAT_INPUT_INTEXT);this.appendDummyInput("AT");this.setInputsInline(true);this.updateAt(true);this.setTooltip(Blockly.LANG_TEXT_CHARAT_TOOLTIP)},mutationToDom:function(){var a=document.createElement("mutation");var b=this.getInput("AT").type==Blockly.INPUT_VALUE;a.setAttribute("at",b);return a},domToMutation:function(a){var b=(a.getAttribute("at")!="false");this.updateAt(b)},updateAt:function(a){this.removeInput("AT");if(a){this.appendValueInput("AT").setCheck(Number)}else{this.appendDummyInput("AT")}var b=new Blockly.FieldDropdown(this.WHERE,function(d){var c=(d=="FROM_START")||(d=="FROM_END");if(c!=a){var e=this.sourceBlock_;e.updateAt(c);e.setTitleValue(d,"WHERE");return null}return undefined});this.getInput("AT").appendTitle(Blockly.LANG_TEXT_CHARAT_GET).appendTitle(b,"WHERE")}};Blockly.Language.text_charAt.WHERE=[[Blockly.LANG_TEXT_CHARAT_FROM_START,"FROM_START"],[Blockly.LANG_TEXT_CHARAT_FROM_END,"FROM_END"],[Blockly.LANG_TEXT_CHARAT_FIRST,"FIRST"],[Blockly.LANG_TEXT_CHARAT_LAST,"LAST"],[Blockly.LANG_TEXT_CHARAT_RANDOM,"RANDOM"]];Blockly.Language.text_changeCase={helpUrl:Blockly.LANG_TEXT_CHANGECASE_HELPURL,init:function(){this.setColour(160);this.appendValueInput("TEXT").setCheck(String).appendTitle(Blockly.LANG_TEXT_CHANGECASE_TITLE_TO).appendTitle(new Blockly.FieldDropdown(this.OPERATORS),"CASE");this.setOutput(true,String);this.setTooltip(Blockly.LANG_TEXT_CHANGECASE_TOOLTIP)}};Blockly.Language.text_changeCase.OPERATORS=[[Blockly.LANG_TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[Blockly.LANG_TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[Blockly.LANG_TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];Blockly.Language.text_trim={helpUrl:Blockly.LANG_TEXT_TRIM_HELPURL,init:function(){this.setColour(160);var a=new Blockly.FieldDropdown(this.OPERATORS,function(c){var b=(c=="BOTH");this.sourceBlock_.updatePlural(b)});this.appendValueInput("TEXT").setCheck(String).appendTitle(Blockly.LANG_TEXT_TRIM_TITLE_SPACE).appendTitle(a,"MODE").appendTitle(Blockly.LANG_TEXT_TRIM_TITLE_SIDES,"SIDES");this.setOutput(true,String);this.setTooltip(Blockly.LANG_TEXT_TRIM_TOOLTIP)},mutationToDom:function(){var a=document.createElement("mutation");var b=(this.getTitleValue("MODE")=="BOTH");a.setAttribute("plural",b);return a},domToMutation:function(b){var a=(b.getAttribute("plural")=="true");this.updatePlural(a)},updatePlural:function(a){this.setTitleValue(a?Blockly.LANG_TEXT_TRIM_TITLE_SIDES:Blockly.LANG_TEXT_TRIM_TITLE_SIDE,"SIDES")}};Blockly.Language.text_trim.OPERATORS=[[Blockly.LANG_TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[Blockly.LANG_TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[Blockly.LANG_TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];Blockly.Language.text_print={helpUrl:Blockly.LANG_TEXT_PRINT_HELPURL,init:function(){this.setColour(160);this.appendValueInput("TEXT").appendTitle(Blockly.LANG_TEXT_PRINT_TITLE_PRINT);this.setPreviousStatement(true);this.setNextStatement(true);this.setTooltip(Blockly.LANG_TEXT_PRINT_TOOLTIP)}};Blockly.Language.text_prompt={helpUrl:Blockly.LANG_TEXT_PROMPT_HELPURL,init:function(){this.setColour(160);this.appendDummyInput().appendTitle(Blockly.LANG_TEXT_PROMPT_TITLE_PROMPT_FOR).appendTitle(new Blockly.FieldDropdown(this.TYPES),"TYPE").appendTitle(Blockly.LANG_TEXT_PROMPT_TITILE_WITH_MESSAGE).appendTitle(new Blockly.FieldImage(Blockly.pathToBlockly+"media/quote0.png",12,12)).appendTitle(new Blockly.FieldTextInput(""),"TEXT").appendTitle(new Blockly.FieldImage(Blockly.pathToBlockly+"media/quote1.png",12,12));this.setOutput(true,[Number,String]);var a=this;this.setTooltip(function(){return(a.getTitleValue("TYPE")=="TEXT")?Blockly.LANG_TEXT_PROMPT_TOOLTIP_TEXT:Blockly.LANG_TEXT_PROMPT_TOOLTIP_NUMBER})}};Blockly.Language.text_prompt.TYPES=[[Blockly.LANG_TEXT_PROMPT_TYPE_TEXT,"TEXT"],[Blockly.LANG_TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];